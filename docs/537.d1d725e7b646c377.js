"use strict";(self.webpackChunkstore_assignment=self.webpackChunkstore_assignment||[]).push([[537],{8537:(ne,E,s)=>{s.r(E),s.d(E,{ProductsModule:()=>ee});var g=s(4755),x=s(2480),j=s(394),_=s(6223);class X{constructor(r){this.totalLength=void 0,this.index=0,this.size=10,this.search=null,this.list=[],this.pageSizeOptions=[10,20,50,100],r&&Object.keys(r).length&&Object.assign(this,r)}}class z extends X{constructor(r){super(r),this.productsLoaded=!1,this.totalPrice=0,r&&Object.keys(r).length&&Object.assign(this,r)}}var P=s(2076),A=s(5698),N=s(9300),tt=s(4351),b=s(3900),w=s(8372),v=s(8505),C=s(5855);const M_indexPage=(o,r="page")=>{const e=o.get(r);return e?+e:0},M_indexSize=(o,r="size")=>{const e=o.get(r);return e?+e:10},M_search=(o,r="search")=>{const e=o.get(r);return e&&e.trim()||null};var t=s(2223),d=s(9401),et=s(2843),ot=s(262),nt=s(6602),rt=s(2602),y=s(3081),U=s(2018);let k=(()=>{class o{constructor(e,n,i){this._connectionService=e,this._translateService=n,this._toasterService=i,this.endpoints=new nt.A,this.allProducts$=this._connectionService.get(this.endpoints.products.getAllProducts),this.getProduct=a=>this._connectionService.get(this.endpoints.products.getProduct+a),this.deleteProduct=a=>this._connectionService.delete(this.endpoints.products.deleteProduct+a).pipe((0,ot.K)(c=>(this._toasterService.error(this._translateService.instant("deleteFailed")),(0,et._)(()=>c))),(0,v.b)(()=>this._toasterService.success(this._translateService.instant("deleteSuccess")))),this.createNewProduct=a=>this._connectionService.post(this.endpoints.products.addNewProduct,a),this.updateProduct=a=>this._connectionService.put(this.endpoints.products.updateProduct+a?.data.id,a)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(rt.M),t.LFG(y.sK),t.LFG(U._W))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var h=(()=>((h=h||{}).SMALL="400px",h.MEDIUM="600px",h.LARGE="900px",h.X_LARGE="1200px",h.FULL="95%",h))(),q=s(6286),D=s(430),L=s(846);let it=(()=>{class o{constructor(e,n){this.dialogRef=e,this.data=n,this.ButtonTypes=_.qh,this.ButtonColors=_.Tt}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(q.so),t.Y36(q.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["confirmation-dialog"]],decls:17,vars:10,consts:[[1,"flex","flex-col","justify-between","items-stretch","relative","overflow-hidden"],[1,"flex","justify-end","items-center"],["icon","close",1,"mt-[5px]","mx-[5px]",3,"matType","clicked"],[1,"flex","flex-row","flex-auto","items-center","sm:items-start","sm:p-4","p-2"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","sm:mx-4","mx-2","rounded-full",3,"ngClass"],[2,"height","25px","width","25px","font-size","25px"],[1,"flex","flex-col","items-start","mt-4","sm:mt-0","sm:pe-8","space-y-1","text-start"],[1,"sm:text-lg","text-sm","sm:leading-6","leading-3","sm:font-medium","font-normal"],[3,"innerText"],[1,"text-secondary","sm:text-base","text-xs","sm:font-normal","font-light"],[1,"flex","items-center","justify-center","sm:justify-end","px-4","py-[8px]","gap-3","bg-gray-50","border-2","border-gray-100","dark:bg-black","dark:bg-opacity-10"],[1,"w-auto",3,"matType","color","clicked"],[3,"textContent"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-button",2),t.NdJ("clicked",function(){return n.dialogRef.close(!1)}),t.qZA()(),t.TgZ(3,"div",3)(4,"div",4)(5,"mat-icon",5),t._uU(6,"report_gmailerrorred"),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7),t._UZ(9,"span",8),t.qZA(),t.TgZ(10,"div",9),t._UZ(11,"span",8),t.qZA()()(),t.TgZ(12,"div",10)(13,"app-button",11),t.NdJ("clicked",function(){return n.dialogRef.close(!0)}),t._UZ(14,"span",12),t.qZA(),t.TgZ(15,"app-button",11),t.NdJ("clicked",function(){return n.dialogRef.close(!1)}),t._UZ(16,"span",12),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("matType",n.ButtonTypes.icon),t.xp6(2),t.Q6J("ngClass"," text-red-600 bg-red-100 dark:text-red-50 dark:bg-red-600"),t.xp6(5),t.Q6J("innerText",n.data.title),t.xp6(2),t.Q6J("innerText",n.data.message),t.xp6(2),t.Q6J("matType",n.ButtonTypes.flat)("color",n.ButtonColors.warn),t.xp6(1),t.Q6J("textContent",n.data.ok),t.xp6(1),t.Q6J("matType",n.ButtonTypes.stroked)("color",n.ButtonColors.basic),t.xp6(1),t.Q6J("textContent",n.data.close))},dependencies:[g.mk,D.Hw,L.r]}),o})();var at=s(8356);let Q=(()=>{class o{constructor(e,n,i){this.dialog=e,this._translateService=n,this._direction=i}Confirm(e,n,i,a=this._translateService.instant("cancel")){return this.dialog.open(it,{width:h.MEDIUM,direction:this._direction.direction(),hasBackdrop:!0,restoreFocus:!1,disableClose:!0,closeOnNavigation:!0,data:{title:n,message:e,ok:i,close:a}}).afterClosed().pipe((0,A.q)(1))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(q.uw),t.LFG(y.sK),t.LFG(at.m))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var O=s(9026),st=s(3276),lt=s(6709),V=s(6782),ct=s(1954),R=s(5965);function dt(o,r){1&o&&(t.TgZ(0,"th",13),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"th",13),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"th",13),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"th",13),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"th",13),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"th",13),t._uU(16),t.ALo(17,"translate"),t.qZA(),t._UZ(18,"th",13)),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,6,"image")," "),t.xp6(3),t.hij(" ",t.lcZ(5,8,"name")," "),t.xp6(3),t.hij(" ",t.lcZ(8,10,"price")," "),t.xp6(3),t.hij(" ",t.lcZ(11,12,"description")," "),t.xp6(3),t.hij(" ",t.lcZ(14,14,"discountPercentage")," "),t.xp6(3),t.hij(" ",t.lcZ(17,16,"createdAt")," "))}const ut=function(o){return["/dashboard/products/edit",o]};function pt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"td",14),t._UZ(1,"img",15),t.qZA(),t.TgZ(2,"td",16),t._uU(3),t.qZA(),t.TgZ(4,"td",14),t._uU(5),t.qZA(),t.TgZ(6,"td",14),t._uU(7),t.qZA(),t.TgZ(8,"td",14),t._uU(9),t.qZA(),t.TgZ(10,"td",14),t._uU(11),t.ALo(12,"date"),t.qZA(),t.TgZ(13,"td",17),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(14,"div",18),t._UZ(15,"app-button",19),t.ALo(16,"translate"),t.TgZ(17,"app-button",20),t.NdJ("clicked",function(){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.onDeleteProduct(a))}),t.ALo(18,"translate"),t.qZA()()()}if(2&o){const e=r.$implicit,n=t.oxw();let i,a,c,u,p;t.xp6(1),t.Q6J("ngSrc",(null==e||null==e.attributes?null:e.attributes.imageUrl)||"assets/images/istockphoto.jpg"),t.xp6(2),t.hij(" ",null!==(i=null==e||null==e.attributes?null:e.attributes.name)&&void 0!==i?i:"\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640"," "),t.xp6(2),t.hij(" ",null!==(a=null==e||null==e.attributes?null:e.attributes.price)&&void 0!==a?a:"\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640"," "),t.xp6(2),t.hij(" ",null!==(c=null==e||null==e.attributes?null:e.attributes.desc)&&void 0!==c?c:"\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640"," "),t.xp6(2),t.hij(" ",null!==(u=null==e||null==e.attributes?null:e.attributes.discountPercentage)&&void 0!==u?u:"\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640"," "),t.xp6(2),t.hij(" ",null!==(p=t.xi3(12,13,null==e||null==e.attributes?null:e.attributes.createdAt,"dd-MM-YYYY"))&&void 0!==p?p:"\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640"," "),t.xp6(4),t.Q6J("routerLink",t.VKq(20,ut,null==e?null:e.id))("matType",n.ButtonTypes.miniFap)("color",n.ButtonColors.primary)("toolTip",t.lcZ(16,16,"edit")),t.xp6(2),t.Q6J("color",n.ButtonColors.warn)("matType",n.ButtonTypes.miniFap)("toolTip",t.lcZ(18,18,"delete"))}}function mt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"mat-paginator",23),t.NdJ("page",function(i){t.CHM(e);const a=t.oxw(2);return t.KtG(a.onPageChange(i))}),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("length",e.productListController.totalLength)("pageSize",e.productListController.size)("pageSizeOptions",e.productListController.pageSizeOptions)}}function gt(o,r){if(1&o&&(t.TgZ(0,"div",21),t.YNc(1,mt,1,3,"mat-paginator",22),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!!e.productListController)}}function ht(o,r){1&o&&(t._UZ(0,"no-data",24),t.ALo(1,"translate")),2&o&&t.Q6J("text",t.lcZ(1,1,"noData"))}const ft=function(){return{y:"80px",delay:"700ms"}},I=function(o){return{value:"*",params:o}};function xt(o,r){if(1&o&&(t.TgZ(0,"div",25)(1,"span",26),t._uU(2),t.qZA(),t.TgZ(3,"span",27),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&o){const e=t.oxw();t.Q6J("@animate",t.VKq(6,I,t.DdM(5,ft))),t.xp6(2),t.Oqu(e.productListController.totalPrice),t.xp6(2),t.Oqu(t.lcZ(5,3,"totalPrice"))}}const _t=function(){return{value:"100"}},vt=function(){return{x:"-40px",delay:"150ms"}},Ct=function(){return{x:"40px",delay:"150ms"}};let Y=(()=>{class o{constructor(e,n,i,a,c,u,p){this._fb=e,this._router=n,this._route=i,this._destroyRef=a,this._productsService=c,this._confirmService=u,this._translateService=p,this.search=this._fb.control(null),this.productListController=new z,this.ButtonTypes=_.qh,this.ButtonColors=_.Tt,this.onDeleteProduct=l=>{this._confirmService.Confirm(`${this._translateService.instant("from")+" "+this._translateService.instant("delete")} (${l.attributes?.name.split("").slice(0,40).join("")}...) ?`,this._translateService.instant("sure"),this._translateService.instant("delete")).pipe((0,A.q)(1),(0,N.h)(Boolean),(0,tt.b)(()=>this._productsService.deleteProduct(l.id)),(0,b.w)(()=>this._getProducts())).subscribe()},this.onPageChange=l=>{(0,P.D)(this._router.navigate([],{queryParams:{index:l.pageIndex||null,size:l.pageSize||null},queryParamsHandling:"merge"})).pipe((0,A.q)(1)).subscribe()},this._searchChangeHandler=()=>{this.search.valueChanges.pipe((0,w.b)(500),(0,b.w)(l=>(0,P.D)(this._router.navigate([],{queryParams:{search:l||null},queryParamsHandling:"merge"}))),(0,C.sL)(this._destroyRef)).subscribe()},this._paramsChanges=()=>{this._route.queryParamMap.pipe((0,v.b)(l=>{const f={index:M_indexPage(l,"index"),size:M_indexSize(l,"size"),search:M_search(l,"search")};this.productListController=new z({...this.productListController,...f}),this.search.patchValue(f?.search)}),(0,b.w)(()=>this._getProducts()),(0,C.sL)(this._destroyRef)).subscribe()},this._getProducts=()=>{this.productListController.productsLoaded=!1;const{index:l,size:f,search:W}=this.productListController;return this._productsService.allProducts$.pipe((0,v.b)(T=>{T?.data.length&&(this.productListController.list=(W?T?.data.filter(J=>J?.attributes?.name?.toLowerCase().includes(W?.toLowerCase())):T?.data)?.slice(l?l*f:0,l?l*f+10:f),this.productListController.totalLength=T?.meta?.pagination?.total,this.productListController.totalPrice=T?.data.reduce((J,oe)=>J+Number((oe?.attributes?.price||"0").replace(/[$]/g,"")),0),this.productListController.productsLoaded=!0)}))}}ngOnInit(){this._paramsChanges(),this._searchChangeHandler()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.qu),t.Y36(x.F0),t.Y36(x.gz),t.Y36(t.ktI),t.Y36(k),t.Y36(Q),t.Y36(y.sK))},o.\u0275cmp=t.Xpm({type:o,selectors:[["products-list"]],decls:19,vars:23,consts:[[1,"w-full","h-full","flex","flex-col","justify-center","items-stretch"],[1,"h-32","bg-blue-200"],[1,"flex","justify-center","items-start"],[1,"sm:w-11/12","w-full","flex","flex-col","justify-center","items-stretch","sm:gap-2","gap-1","-mt-24"],[1,"flex","flex-wrap","justify-between","items-center"],["outlineOption","2.5px solid #03a9f4",1,"sm:h-11","h-8",3,"formControl","placeholder"],["routerLink","/dashboard/products/create","icon","post_add","btnClass","bg-gray-600 outline-none text-white text-lg py-1 shadow-md",3,"matType","color","text"],[1,"table-scrollable","max-h-[77vh]","shadow-md","bg-white",3,"data","dataLoaded","colSpanCount"],["headers",""],["row",""],["pagination",""],["noData",""],["class","fixed bottom-[80px] right-[80px] z-50 h-20 w-28 flex flex-col justify-center items-center mat-elevation-z7 rounded-md bg-white",4,"ngIf"],[1,"sm:text-[14px]","text-xs","text-start"],[1,"sm:text-[15px]","text-xs","break-words"],["width","100","height","80","loading","lazy",1,"rounded-xl","border-2","border-gray-200","shadow-md","hover:scale-110",3,"ngSrc"],[1,"max-w-[300px]","sm:text-[14px]","leading-5","text-xs","break-words"],[3,"click"],[1,"h-full","w-auto","flex","justify-start","items-center","sm:gap-2","gap-[3px]"],["icon","edit_note","btnClass","bg-gray-600 text-white",3,"routerLink","matType","color","toolTip"],["icon","delete",3,"color","matType","toolTip","clicked"],[1,"h-auto","w-full","bg-white","flex","justify-end","items-center","px-2"],["panelClass","bg-transparent","class","w-1/2",3,"length","pageSize","pageSizeOptions","page",4,"ngIf"],["panelClass","bg-transparent",1,"w-1/2",3,"length","pageSize","pageSizeOptions","page"],[3,"text"],[1,"fixed","bottom-[80px]","right-[80px]","z-50","h-20","w-28","flex","flex-col","justify-center","items-center","mat-elevation-z7","rounded-md","bg-white"],[1,"font-semibold","text-2xl","truncate"],[1,"font-medium","text-xs"]],template:function(e,n){1&e&&(t.TgZ(0,"page-component",0),t._UZ(1,"div",1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"magic-search-input",5),t.ALo(6,"translate"),t._UZ(7,"app-button",6),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"app-table",7),t.YNc(10,dt,19,18,"ng-template",null,8,t.W1O),t.YNc(12,pt,19,22,"ng-template",null,9,t.W1O),t.YNc(14,gt,2,1,"ng-template",null,10,t.W1O),t.YNc(16,ht,2,3,"ng-template",null,11,t.W1O),t.qZA(),t.YNc(18,xt,6,8,"div",12),t.qZA()()()),2&e&&(t.Q6J("@animateStagger",t.DdM(16,_t)),t.xp6(5),t.Q6J("@animate",t.VKq(18,I,t.DdM(17,vt)))("formControl",n.search)("placeholder",t.lcZ(6,12,"search")+"..."),t.xp6(2),t.Q6J("@animate",t.VKq(21,I,t.DdM(20,Ct)))("matType",n.ButtonTypes.round_stroked)("color",n.ButtonColors.primary)("text",t.lcZ(8,14,"create")),t.xp6(2),t.Q6J("data",n.productListController.list)("dataLoaded",n.productListController.productsLoaded)("colSpanCount",6),t.xp6(9),t.Q6J("ngIf",n.productListController.productsLoaded))},dependencies:[g.O5,x.rH,d.JJ,d.oH,st.NW,lt.a,V.U,g.Zd,L.r,ct.d,R.C,g.uU,y.X$],data:{animation:[j.F]}}),o})();var yt=s(4040);const bt={name:{required:"Title is required"},price:{required:"Price is required",min:"Price should be grater than 1$"},fromDate:{required:"From date is required"},toDate:{required:"To date is required"}};var Zt=s(4968),Tt=s(6451),B=s(4004),G=s(8746);const H=(o,r)=>{if(o===r)return!0;if("object"==typeof o&&null!==o&&"object"==typeof r&&null!==r){if(Object.keys(o).length!==Object.keys(r).length||o.length!==r.length)return!1;for(const e in o)if(!H(o[e],r[e]))return!1;return!0}return!1};function K(o,r,e,n,i,a,c){try{var u=o[a](c),p=u.value}catch(l){return void e(l)}u.done?r(p):Promise.resolve(p).then(n,i)}let Lt=(()=>{class o{unloadNotification(e){var n=this;return function Pt(o){return function(){var r=this,e=arguments;return new Promise(function(n,i){var a=o.apply(r,e);function c(p){K(a,n,i,c,u,"next",p)}function u(p){K(a,n,i,c,u,"throw",p)}c(void 0)})}}(function*(){n.formChanges&&(e.returnValue=!0)})()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=t.lG2({type:o,selectors:[["","appSaveChanges",""]],hostBindings:function(e,n){1&e&&t.NdJ("beforeunload",function(a){return n.unloadNotification(a)},!1,t.Jf7)}}),o})();var Z=s(8280),S=s(9114),St=s(8097),At=s(1728);const wt=function(){return{y:"-40px",delay:"100ms"}},m=function(o){return{value:"*",params:o}};function Mt(o,r){if(1&o&&t._UZ(0,"img",27),2&o){const e=t.oxw(2);t.Q6J("@animate",t.VKq(3,m,t.DdM(2,wt)))("ngSrc",e.imageUrl()||"assets/images/istockphoto.jpg")}}const Ut=function(){return{y:"-40px",delay:"150ms"}};function qt(o,r){1&o&&t._UZ(0,"img",28),2&o&&t.Q6J("@animate",t.VKq(2,m,t.DdM(1,Ut)))}const Dt=function(){return{y:"-40px",delay:"200ms"}},It=function(){return{y:"-40px",delay:"250ms"}},Ft=function(){return{y:"-40px",delay:"300ms"}},Jt=function(){return{y:"-40px",delay:"350ms"}},Et=function(){return{y:"-40px",delay:"400ms"}},jt=function(){return{y:"-40px",delay:"450ms"}},zt=function(){return{y:"-40px",delay:"500ms"}},Nt=function(){return{y:"-40px",delay:"550ms"}},kt=function(){return{y:"-40px",delay:"600ms"}};function Qt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"form",5)(1,"div",6),t.YNc(2,Mt,1,5,"img",7),t.YNc(3,qt,1,4,"img",8),t.TgZ(4,"mat-form-field",9)(5,"mat-label"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t._UZ(8,"input",10),t.qZA()(),t.TgZ(9,"mat-form-field",11)(10,"mat-label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"textarea",12),t.TgZ(14,"mat-error"),t._uU(15),t.qZA()(),t.TgZ(16,"mat-form-field",11)(17,"mat-label"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._UZ(20,"input",13),t.TgZ(21,"mat-error"),t._uU(22),t.qZA()(),t.TgZ(23,"mat-form-field",11)(24,"mat-label"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t._UZ(27,"input",14),t.TgZ(28,"mat-icon",15),t._uU(29,"$"),t.qZA(),t.TgZ(30,"mat-error"),t._uU(31),t.qZA()(),t.TgZ(32,"mat-form-field",11)(33,"mat-label"),t._uU(34),t.ALo(35,"translate"),t.qZA(),t._UZ(36,"input",16)(37,"mat-datepicker-toggle",17),t.TgZ(38,"mat-datepicker",null,18)(40,"mat-datepicker-actions")(41,"button",19),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"button",20),t._uU(45),t.ALo(46,"translate"),t.qZA()()()(),t.TgZ(47,"mat-form-field",11)(48,"mat-label"),t._uU(49),t.ALo(50,"translate"),t.qZA(),t._UZ(51,"input",21)(52,"mat-datepicker-toggle",17),t.TgZ(53,"mat-datepicker",null,22)(55,"mat-datepicker-actions")(56,"button",19),t._uU(57),t.ALo(58,"translate"),t.qZA(),t.TgZ(59,"button",20),t._uU(60),t.ALo(61,"translate"),t.qZA()()()(),t.TgZ(62,"mat-form-field",11)(63,"mat-label"),t._uU(64),t.ALo(65,"translate"),t.qZA(),t._UZ(66,"input",23),t.TgZ(67,"mat-icon",15),t._uU(68,"%"),t.qZA(),t.TgZ(69,"mat-error"),t._uU(70),t.qZA()(),t.TgZ(71,"div",24),t._UZ(72,"app-button",25),t.ALo(73,"translate"),t.TgZ(74,"app-button",26),t.NdJ("clicked",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSubmit())}),t.ALo(75,"translate"),t.qZA()()()}if(2&o){const e=t.MAs(39),n=t.MAs(54),i=t.oxw();t.Q6J("formGroup",i.addEditProductForm),t.xp6(2),t.Q6J("ngIf",i.imageUrl()),t.xp6(1),t.Q6J("ngIf",!i.imageUrl()),t.xp6(1),t.Q6J("@animate",t.VKq(66,m,t.DdM(65,Dt))),t.xp6(2),t.Oqu(t.lcZ(7,39,"imageUrl")),t.xp6(3),t.Q6J("@animate",t.VKq(69,m,t.DdM(68,It))),t.xp6(2),t.Oqu(t.lcZ(12,41,"description")),t.xp6(4),t.Oqu(i.displayErrorMessages.desc),t.xp6(1),t.Q6J("@animate",t.VKq(72,m,t.DdM(71,Ft))),t.xp6(2),t.Oqu(t.lcZ(19,43,"name")),t.xp6(4),t.Oqu(i.displayErrorMessages.name),t.xp6(1),t.Q6J("@animate",t.VKq(75,m,t.DdM(74,Jt))),t.xp6(2),t.Oqu(t.lcZ(26,45,"price")),t.xp6(6),t.Oqu(i.displayErrorMessages.price),t.xp6(1),t.Q6J("@animate",t.VKq(78,m,t.DdM(77,Et))),t.xp6(2),t.Oqu(t.lcZ(35,47,"fromDate")),t.xp6(2),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(5),t.hij(" ",t.lcZ(43,49,"cancel")," "),t.xp6(3),t.hij(" ",t.lcZ(46,51,"apply")," "),t.xp6(2),t.Q6J("@animate",t.VKq(81,m,t.DdM(80,jt))),t.xp6(2),t.Oqu(t.lcZ(50,53,"toDate")),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(5),t.hij(" ",t.lcZ(58,55,"cancel")," "),t.xp6(3),t.hij(" ",t.lcZ(61,57,"apply")," "),t.xp6(2),t.Q6J("@animate",t.VKq(84,m,t.DdM(83,zt))),t.xp6(2),t.Oqu(t.lcZ(65,59,"discountPercentage")),t.xp6(6),t.Oqu(i.displayErrorMessages.discountPercentage),t.xp6(2),t.Q6J("@animate",t.VKq(87,m,t.DdM(86,Nt)))("matType",i.buttonTypes.raised)("color",i.buttonColors.warn)("text",t.lcZ(73,61,"cancel")),t.xp6(2),t.Q6J("@animate",t.VKq(90,m,t.DdM(89,kt)))("disabled",i.addEditProductForm.invalid||!i.formChanges)("isLoading",i.submitProcess)("text",t.lcZ(75,63,"save"))("matType",i.buttonTypes.raised)("color",i.buttonColors.primary)}}function Ot(o,r){1&o&&(t.TgZ(0,"div",29)(1,"div",30),t._UZ(2,"div")(3,"div")(4,"div")(5,"div")(6,"div")(7,"div")(8,"div")(9,"div")(10,"div")(11,"div")(12,"div")(13,"div"),t.qZA()())}const Vt=function(o){return{value:o}};let F=(()=>{class o extends Lt{constructor(e,n,i,a,c,u,p){super(),this._fb=e,this._router=n,this._route=i,this._toasterService=a,this._translateService=c,this._productsService=u,this._destroyRef=p,this.addEditProductForm=this._fb.group({imageUrl:[""],name:["",[d.kI.required]],price:[0,[d.kI.required,d.kI.min(1)]],desc:[""],fromDate:[new Date,d.kI.required],toDate:[new Date,d.kI.required],discountPercentage:[0]}),this.imageUrl=(0,C.O4)(this.addEditProductForm.get("imageUrl")?.valueChanges.pipe((0,B.U)(l=>l||"")),{initialValue:""}),this.buttonTypes=_.qh,this.buttonColors=_.Tt,this.displayErrorMessages={},this.submitProcess=!1,this.prodId=null,this.dataLoaded=!1,this._genericValidator=new yt.f(bt),this._cashedFormValues=this.addEditProductForm.getRawValue(),this.onSubmit=()=>{const l={data:{id:this.prodId,...this.addEditProductForm.value,price:this.addEditProductForm.value?.price+"$",discountPercentage:this.addEditProductForm.value?.discountPercentage+"%"}};this.submitProcess=!0,this.prodId?this._updateHandler(l):this._createHandler(l)},this._createHandler=l=>{delete l.data.id,this._productsService.createNewProduct({...l}).pipe((0,v.b)(()=>{this._toasterService.success(this._translateService.instant("prodCreatedSuccess")),this._cashedFormValues=this.addEditProductForm.getRawValue()}),(0,w.b)(500),(0,b.w)(()=>(0,P.D)(this._router.navigate(["/dashboard/products"]))),(0,G.x)(()=>this.submitProcess=!1),(0,C.sL)(this._destroyRef)).subscribe()},this._updateHandler=l=>{this._productsService.updateProduct({...l}).pipe((0,v.b)(()=>{this._toasterService.success(this._translateService.instant("prodUpdateSuccess")),this._cashedFormValues=this.addEditProductForm.getRawValue()}),(0,w.b)(500),(0,b.w)(()=>(0,P.D)(this._router.navigate(["/dashboard/products"]))),(0,G.x)(()=>this.submitProcess=!1),(0,C.sL)(this._destroyRef)).subscribe()},this._paseProduct=()=>{this._route.paramMap.pipe((0,B.U)(l=>{const f=l.get("id");return this.prodId=f,f}),(0,N.h)(Boolean),(0,b.w)(l=>this._productsService.getProduct(Number(l))),(0,v.b)(l=>{this.addEditProductForm.patchValue({...l?.data?.attributes,price:Number((l?.data.attributes?.price||"0").replace(/[$]/g,"")),discountPercentage:Number((l?.data.attributes?.discountPercentage||"0").replace(/[%]/g,""))}),this.dataLoaded=!0,this._cashedFormValues=this.addEditProductForm.getRawValue()}),(0,C.sL)(this._destroyRef)).subscribe()}}get formChanges(){return!H(this.addEditProductForm.getRawValue(),this._cashedFormValues)}ngOnInit(){this._paseProduct()}ngAfterViewInit(){const e=this.formInputElements.map(n=>(0,Zt.R)(n.nativeElement,"blur"));(0,Tt.T)(this.addEditProductForm.valueChanges,...e).pipe((0,v.b)(()=>{this.displayErrorMessages=this._genericValidator.processMessages(this.addEditProductForm)}),(0,C.sL)(this._destroyRef)).subscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.qu),t.Y36(x.F0),t.Y36(x.gz),t.Y36(U._W),t.Y36(y.sK),t.Y36(k),t.Y36(t.ktI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["create-edit-product"]],viewQuery:function(e,n){if(1&e&&t.Gf(d.u,5,t.SBq),2&e){let i;t.iGM(i=t.CRH())&&(n.formInputElements=i)}},features:[t.qOj],decls:7,vars:8,consts:[[1,"w-full","h-full","flex","flex-col","justify-center","items-stretch",3,"pageTitle"],[1,"h-32","bg-slate-200"],[1,"flex","justify-center","items-start"],["class","w-11/12 h-full grid sm:grid-cols-2 grid-cols-1 sm:gap-3 gap-2 content-start p-0 m-0 -mt-24 pb-10",3,"formGroup",4,"ngIf","ngIfElse"],["loader",""],[1,"w-11/12","h-full","grid","sm:grid-cols-2","grid-cols-1","sm:gap-3","gap-2","content-start","p-0","m-0","-mt-24","pb-10",3,"formGroup"],[1,"flex","flex-col","justify-center","items-center","gap-2"],["width","200","height","200","loading","lazy","class","max-h-[200px] rounded-xl border-2 border-gray-200 shadow-md hover:scale-110 place-self-center",3,"ngSrc",4,"ngIf"],["ngSrc","assets/images/istockphoto.jpg","width","200","height","200","loading","lazy","class","rounded-xl border-2 border-gray-200 shadow-md hover:scale-110 place-self-center",4,"ngIf"],["appearance","fill",1,"w-full"],["formControlName","imageUrl","matInput",""],["appearance","fill"],["formControlName","desc","matInput","","rows","6"],["formControlName","name","matInput",""],["formControlName","price","matInput","","type","number"],["matSuffix",""],["formControlName","fromDate","matInput","",3,"matDatepicker"],["matIconSuffix","",3,"for"],["fromDate",""],["mat-button","","matDatepickerCancel",""],["mat-raised-button","","color","primary","matDatepickerApply",""],["formControlName","toDate","matInput","",3,"matDatepicker"],["toDate",""],["formControlName","discountPercentage","matInput","","type","number"],[1,"flex","justify-center","items-center","gap-3"],["routerLink","/dashboard/products","btnClass","sm:w-40",3,"matType","color","text"],["btnClass","sm:w-40",3,"disabled","isLoading","text","matType","color","clicked"],["width","200","height","200","loading","lazy",1,"max-h-[200px]","rounded-xl","border-2","border-gray-200","shadow-md","hover:scale-110","place-self-center",3,"ngSrc"],["ngSrc","assets/images/istockphoto.jpg","width","200","height","200","loading","lazy",1,"rounded-xl","border-2","border-gray-200","shadow-md","hover:scale-110","place-self-center"],[1,"p-0","h-auto","min-h-[50vh]","w-full","flex","justify-center","items-center"],[1,"lds-spinner"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-component",0),t.ALo(1,"translate"),t._UZ(2,"div",1),t.TgZ(3,"div",2),t.YNc(4,Qt,76,92,"form",3),t.qZA()(),t.YNc(5,Ot,14,0,"ng-template",null,4,t.W1O)),2&e){const i=t.MAs(6);let a;t.Q6J("@animateStagger",t.VKq(6,Vt,n.prodId?"150":"50"))("pageTitle",n.prodId?null==(a=n.addEditProductForm.get("name"))?null:a.value:t.lcZ(1,4,"newProd")),t.xp6(4),t.Q6J("ngIf",!n.prodId||!!n.prodId&&n.dataLoaded)("ngIfElse",i)}},dependencies:[g.O5,x.rH,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.sg,d.u,Z.Mq,Z.hl,Z.nW,Z.M5,Z.dp,Z.DK,S.KE,S.hX,S.TO,S.R9,St.Nt,At.lW,D.Hw,g.Zd,L.r,R.C,y.X$],data:{animation:[j.F]}}),o})(),$=(()=>{class o{constructor(e,n){this._confirmService=e,this._translateService=n,this.saveChangesGuard=()=>this._confirmService.Confirm(this._translateService.instant("saveChangesMsg"),"",this._translateService.instant("discardChanges"),this._translateService.instant("continueEditing"))}canDeactivate(e,n,i,a){return!e?.formChanges||this.saveChangesGuard()}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(Q),t.LFG(y.sK))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const Rt=[{path:"",component:Y},{path:"create",component:F,canDeactivate:[$]},{path:"edit/:id",component:F,canDeactivate:[$]}];let Yt=(()=>{class o{}return o.Components=[Y,F],o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[x.Bz.forChild(Rt),x.Bz]}),o})();var Bt=s(1884),Gt=s(3649);const Ht=["formControlName",""];function Kt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"label",3)(1,"mat-icon",4),t._uU(2,"add_photo_alternate"),t.qZA(),t.TgZ(3,"input",5,6),t.NdJ("change",function(i){t.CHM(e);const a=t.MAs(4),c=t.oxw();return t.KtG(c.onSelectFile(i,null==a?null:a.files))}),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("matTooltip",e.label)}}function $t(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"app-button",14),t.NdJ("clicked",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.onResetImage())}),t.qZA()}if(2&o){const e=t.oxw(3);t.Q6J("matType",e.ButtonTypes.miniFap)("color",e.ButtonColors.warn)}}function Wt(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",10),t.YNc(1,$t,1,2,"app-button",11),t.TgZ(2,"label",12)(3,"mat-icon",13),t._uU(4,"edit"),t.qZA(),t.TgZ(5,"input",5,6),t.NdJ("change",function(i){t.CHM(e);const a=t.MAs(6),c=t.oxw(2);return t.KtG(c.onSelectFile(i,null==a?null:a.files))}),t.qZA()()()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.showDeleteBtn)}}function Xt(o,r){if(1&o&&(t.TgZ(0,"div",7),t._UZ(1,"img",8),t.YNc(2,Wt,7,1,"div",9),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("src",e.image.preview,t.LSH),t.xp6(1),t.Q6J("ngIf",e.showActions)}}let te=(()=>{class o{constructor(e,n){this._fb=e,this._toastService=n,this._destroyRef=(0,t.f3M)(t.ktI),this.showActions=!0,this.showDeleteBtn=!0,this.label="upload",this.sizeLimit=5,this.formControl=this._fb.control(null,{nonNullable:!0,validators:d.kI.required}),this.ButtonTypes=_.qh,this.ButtonColors=_.Tt,this.image={file:void 0,preview:null},this.onResetImage=()=>{this.image={file:void 0,preview:null}},this.onTouched=()=>{},this.registerOnChange=i=>{this.formControl.valueChanges.subscribe(i)},this.registerOnTouched=i=>this.onTouched=i,this.setDisabledState=i=>{i?this.formControl.disable():this.formControl.enable()},this.validate=()=>this.formControl.valid?null:{invalidForm:{valid:!1,message:"Form fields are invalid"}},this._readFileAImage=i=>{const a=new FileReader;i instanceof File?(a.readAsDataURL(i),a.onload=c=>{const{result:u}=a;this.image={file:i,preview:u}}):this.image={file:void 0,preview:i},this.formControl.setValue(i),this.formControl.updateValueAndValidity()}}ngOnInit(){this.formControl.valueChanges.pipe((0,Bt.x)(),(0,v.b)(e=>this._readFileAImage(e)),(0,C.sL)(this._destroyRef)).subscribe()}onSelectFile(e,n){if(n?.length){const i=n[0],a=new FileReader;if(a.readAsDataURL(e?.target?.files[0]),i&&this.sizeLimit&&i.size>=1e3*this.sizeLimit*1024)return void this._toastService.error("File size is out of the range data upload (5MB) maximum");if(!i||!i.type.match(/image\/*/))return void this._toastService.error("File type is invalid");a.onload=c=>{this.formControl.setValue(i),this.formControl.updateValueAndValidity()}}}writeValue(e){e&&this.formControl.patchValue(e,{emitEvent:!0})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.qu),t.Y36(U._W))},o.\u0275cmp=t.Xpm({type:o,selectors:[["image-picker","formControlName",""],["image-picker","formControl",""],["image-picker","ngModel",""]],inputs:{showActions:"showActions",showDeleteBtn:"showDeleteBtn",label:"label",sizeLimit:"sizeLimit"},standalone:!0,features:[t._Bn([{provide:d.JU,useExisting:(0,t.Gpc)(()=>o),multi:!0},{provide:d.Cf,useExisting:(0,t.Gpc)(()=>o),multi:!0}]),t.jDz],attrs:Ht,decls:3,vars:2,consts:[[1,"flex","justify-center","items-center"],["class","flex justify-center items-center rounded-md m-0 p-[35px] border-2 border-gray-400 border-dashed bg-slate-100 cursor-pointer","for","img-input",3,"matTooltip",4,"ngIf"],["class","w-auto h-auto rounded",4,"ngIf"],["for","img-input",1,"flex","justify-center","items-center","rounded-md","m-0","p-[35px]","border-2","border-gray-400","border-dashed","bg-slate-100","cursor-pointer",3,"matTooltip"],[1,"text-[30px]","font-medium","text-gray-600","align-middle","text-center"],["id","img-input","type","file","hidden","",3,"change"],["input",""],[1,"w-auto","h-auto","rounded"],["width","245","height","130","loading","eager",3,"src"],["class","flex justify-start items-center px-0 gap-2",4,"ngIf"],[1,"flex","justify-start","items-center","px-0","gap-2"],["class","w-auto","toolTip","delete","icon","delete",3,"matType","color","clicked",4,"ngIf"],["matTooltip","edit","matTooltipPosition","above","for","img-input",1,"w-auto","flex","justify-centeritems-center","rounded-full","mat-elevation-z3","bg-gray-600","p-[8px]","cursor-pointer","m-0"],[1,"h-auto","w-auto","font-medium","text-white","text-center","align-middle"],["toolTip","delete","icon","delete",1,"w-auto",3,"matType","color","clicked"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Kt,5,1,"label",1),t.YNc(2,Xt,3,2,"div",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",!(null!=n.image&&n.image.preview)),t.xp6(1),t.Q6J("ngIf",!(null==n.image||!n.image.preview)))},dependencies:[g.ez,g.O5,d.u5,d.UX,O.m,D.Hw,Gt.gM,L.r],styles:["mat-icon[_ngcontent-%COMP%]{width:auto!important;height:auto!important}"]}),o})(),ee=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,Yt,O.m,V.U,te]}),o})()}}]);